<!doctype html>

<head>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.1.2/howler.core.min.js">
  </script>
</head>
<html lang="en">

<body style="background-color: blueviolet; color: black; height: 600vh;">

  </div>
  <script>
    const upsellData = {
      "nudge": "Stay fresh and hydrated all day long!",
      "product": {
        "title": "Hermes - All in one Serum - Naicinamide , Succinic Acid & AlphaArbutin",
        "image": "https://cdn.shopify.com/s/files/1/0637/6194/0660/files/Frame_2147226712.png?v=1751034153"
      },
      "usecase": "Pairing with the face wash, this serum enhances hydration and skin clarity."
    }


    const cartAbondMent = {
      "nudge": "currentAbandonmentValue",
      "handle": "https://shoppiepublic.myshopify.com/cart"

    };


    const stringifiedUpsellData = JSON.stringify(upsellData);

    const stringifiedcartAbondMent = JSON.stringify(cartAbondMent);

    const customer = {
      id: "1234",
      firstName: "sourav",
      lastName: "developer",
      email: "developer@testing.com",
      phone: ""
    };
    
    const shopifyContext = {
      "shop": {
        "name": "devshoppiestore",
        "domain": "devshoppiestore.myshopify.com",
        "email": "shoppie@goshoppie.com",
        "phone": "",
        "address": {
          "address1": "",
          "city": "",
          "zip": "",
          "country": "India"
        },
        "currency": "INR",
        "money_format": "Rs. {{amount}}",
        "products_count": 13,
        "vendors": [
          "devshoppiestore",
          "Hydrogen Vendor",
          "Multi-managed Vendor",
          "Snowboard Vendor"
        ],
        "types": [
          "accessories",
          "giftcard",
          "snowboard"
        ]
      },
      "page_context": {
        "template": "collection",
        "page_title": "skincare",
        "canonical_url": "https://shoppietestingstore.myshopify.com/collections/skincare-1",
        "handle": "skincare-1",
        "current_tags": null,
        "scroll_percentage": 0,
        "time_spent_seconds": 0
      },
      "product": null,
      "customer": {
        "id": "7732601749607",
        "first_name": "Prayag",
        "last_name": "N",
        "email": "prayu.n.manojnair@gmail.com",
        "phone": "",
        "total_spent": "Rs. 0.00",
        "orders_count": 0,
        "addresses_count": 1,
        "default_address": {
          "address1": "Prarthana",
          "address2": "",
          "city": "Pathiriyard",
          "province": "Kerala",
          "zip": "670643",
          "country": "India"
        },
        "orders": [
          {
            "id": "6523394949223",
            "name": "#RM232014",
            "order_number": "RM232014",
            "created_at": "2025-05-13",
            "financial_status": "paid",
            "fulfillment_status": "fulfilled",
            "total_price": "Rs. 3,244.94",
            "items_count": 2,
            "line_items": [
              {
                "title": "The Collection Snowboard: Oxygen",
                "quantity": 2,
                "price": "Rs. 1,025.00",
                "sku": "",
                "product_id": "7261321789543",
                "variant_id": "41336100356199",
                "image": "//devshoppiestore.myshopify.com/cdn/shop/files/Main_d624f226-0a89-4fe1-b333-0d1548b43c06_small.jpg?v=1745840236"
              },
              {
                "title": "The Complete Snowboard - Ice",
                "quantity": 1,
                "price": "Rs. 699.95",
                "sku": "",
                "product_id": "7261321691239",
                "variant_id": "41336100028519",
                "image": "//devshoppiestore.myshopify.com/cdn/shop/files/Main_589fc064-24a2-4236-9eaf-13b2bd35d21d_small.jpg?v=1745840236"
              }
            ],
            "transactions": [
              {
                "id": "8767245058151",
                "amount": "Rs. 3,244.94",
                "status": "success",
                "kind": "sale",
                "gateway": "bogus",
                "created_at": "2025-05-13"
              }
            ],
            "fulfillments": []
          },
          {
            "id": "6521903448167",
            "name": "#RM238417",
            "order_number": "RM238417",
            "created_at": "2025-05-12",
            "financial_status": "paid",
            "fulfillment_status": "unfulfilled",
            "total_price": "Rs. 1,592.94",
            "items_count": 2,
            "line_items": [
              {
                "title": "The Collection Snowboard: Hydrogen",
                "quantity": 1,
                "price": "Rs. 600.00",
                "sku": "",
                "product_id": "7261321625703",
                "variant_id": "41336099995751",
                "image": "//devshoppiestore.myshopify.com/cdn/shop/files/Main_0a40b01b-5021-48c1-80d1-aa8ab4876d3d_small.jpg?v=1745840236"
              },
              {
                "title": "The Collection Snowboard: Liquid",
                "quantity": 1,
                "price": "Rs. 749.95",
                "sku": "",
                "product_id": "7261321887847",
                "variant_id": "41336100454503",
                "image": "//devshoppiestore.myshopify.com/cdn/shop/files/Main_b13ad453-477c-4ed1-9b43-81f3345adfd6_small.jpg?v=1745840237"
              }
            ],
            "transactions": [
              {
                "id": "8764493824103",
                "amount": "Rs. 1,592.94",
                "status": "success",
                "kind": "sale",
                "gateway": "bogus",
                "created_at": "2025-05-12"
              }
            ],
            "fulfillments": []
          }
        ]
      },
      // "product": {
      //   "id": "7910441746612",
      //   "title": "Helios - 3 In 1 Sunscreen (Resorcinol , Glabridin &amp; Kojic Acid)",
      //   "handle": "sunscreen",
      //   "description": "&lt;p&gt;Men&#39;s shield for outdoor adventures&lt;/p&gt;",
      //   "price": "Rs. 850.00",
      //   "price_min": "Rs. 850.00",
      //   "price_max": "Rs. 850.00",
      //   "available": true,
      //   "type": "",
      //   "vendor": "Reginald Men",
      //   "tags": [
      //     "Sunscreen"
      //   ],
      //   "published_at": "2025-01-15",
      //   "featured_image": "//reginaldmen.com/cdn/shop/files/Frame_2147225251_4b69f51f-4400-4373-b387-b3ba339fb233_medium.png?v=1749213544",
      //   "image_count": 8,
      //   "has_only_default_variant": false,
      //   "options": [
      //     "weight"
      //   ],
      //   "variants_count": 1,
      //   "selected_variant": null
      // },

      "collection": {
        "id": "",
        "title": "Products",
        "handle": "all",
        "description": "",
        "products_count": 13,
        "all_products_count": 13,
        "all_tags": [
          "Accessory",
          "Premium",
          "Snow",
          "Snowboard",
          "Sport",
          "Winter"
        ],
        "all_types": [
          "accessories",
          "giftcard",
          "snowboard"
        ],
        "all_vendors": [
          "devshoppiestore",
          "Hydrogen Vendor",
          "Multi-managed Vendor",
          "Snowboard Vendor"
        ]
      },
      "cart": {
        "item_count": 3,
        "total_price": "Rs. 2,109.85",
        "original_total_price": "Rs. 2,109.85",
        "total_discount": "Rs. 0.00",
        "items": [
          {
            "id": "41336100454503",
            "key": "41336100454503:be8fd193526c109eec26fe501e0a06ff",
            "product_id": "7261321887847",
            "variant_id": "41336100454503",
            "title": "The Collection Snowboard: Liquid",
            "url": "/products/the-collection-snowboard-liquid?variant=41336100454503",
            "quantity": 1,
            "price": "Rs. 749.95",
            "line_price": "Rs. 749.95",
            "original_price": "Rs. 749.95",
            "original_line_price": "Rs. 749.95",
            "properties": [],
            "image": "//devshoppiestore.myshopify.com/cdn/shop/files/Main_b13ad453-477c-4ed1-9b43-81f3345adfd6_small.jpg?v=1745840237",
            "product": {
              "handle": "the-collection-snowboard-liquid",
              "type": "snowboard",
              "vendor": "Hydrogen Vendor"
            },
            "variant": {
              "title": "Default Title",
              "sku": "",
              "available": true
            }
          },
          {
            "id": "41336100421735",
            "key": "41336100421735:303aa4014087b34b66c11aa20768ac08",
            "product_id": "7261321822311",
            "variant_id": "41336100421735",
            "title": "The Multi-managed Snowboard",
            "url": "/products/the-multi-managed-snowboard?variant=41336100421735",
            "quantity": 1,
            "price": "Rs. 629.95",
            "line_price": "Rs. 629.95",
            "original_price": "Rs. 629.95",
            "original_line_price": "Rs. 629.95",
            "properties": [],
            "image": "//devshoppiestore.myshopify.com/cdn/shop/files/Main_9129b69a-0c7b-4f66-b6cf-c4222f18028a_small.jpg?v=1745840237",
            "product": {
              "handle": "the-multi-managed-snowboard",
              "type": "snowboard",
              "vendor": "Multi-managed Vendor"
            },
            "variant": {
              "title": "Default Title",
              "sku": "sku-managed-1",
              "available": true
            }
          },
          {
            "id": "41336100323431",
            "key": "41336100323431:5e89a9c54e38dedc2559e0eda2e18850",
            "product_id": "7261321756775",
            "variant_id": "41336100323431",
            "title": "The Multi-location Snowboard",
            "url": "/products/the-multi-location-snowboard?variant=41336100323431",
            "quantity": 1,
            "price": "Rs. 729.95",
            "line_price": "Rs. 729.95",
            "original_price": "Rs. 729.95",
            "original_line_price": "Rs. 729.95",
            "properties": [],
            "image": "//devshoppiestore.myshopify.com/cdn/shop/files/Main_0a4e9096-021a-4c1e-8750-24b233166a12_small.jpg?v=1745840236",
            "product": {
              "handle": "the-multi-location-snowboard",
              "type": "snowboard",
              "vendor": "devshoppiestore"
            },
            "variant": {
              "title": "Default Title",
              "sku": "",
              "available": true
            }
          }
        ]
      },
      "abandoned_checkout": null,
      "search": null
    }



    const script = document.createElement('script');
    script.src = 'dist/anythingllm-chat-widget.js';
    // 'dist/anythingllm-chat-widget.js';

    script.setAttribute('data-base-api-url', 'https://anythingllm.goshoppie.com/api/embed');
    script.setAttribute('data-host', 'c2hvcHBpZXB1YmxpYy5teXNob3BpZnkuY29t');
    script.setAttribute('data-customer', JSON.stringify(customer));
    script.setAttribute('data-shopify-context', JSON.stringify(shopifyContext));

    document.body.appendChild(script);
    // Scroll event listener to fire shoppieAINudgeUpdated
    let fired2 = false;
    let fired4 = false;

    window.addEventListener('scroll', () => {
      const scrollHeight = window.scrollY / window.innerHeight; // Scroll position in vh

      if (scrollHeight >= 2 && !fired2) {
        console.log('Firing shoppieAINudgeUpdated at 2vh:', new Date().toISOString());
        const event = new CustomEvent('shoppieAINudgeUpdated', {
          detail: {
            key: 'shoppieAINudgeMessage', value: stringifiedUpsellData
          }
        });
        window.dispatchEvent(event);
        fired2 = true;
      }

      if (scrollHeight >= 4 && !fired4) {
        console.log('Firing shoppieAINudgeUpdated at 4vh:', new Date().toISOString());
        const event = new CustomEvent('shoppieAINudgeUpdated', {
          detail: { key: 'shoppieAINudgeMessage', value: stringifiedcartAbondMent }
        });
        window.dispatchEvent(event);
        fired4 = true;
      }
    });

    window.addEventListener("chatbot_open", (event) => {
      console.log("Chatbot open state changed:", event.detail.value);
      // Handle the event, e.g., trigger analytics or UI updates
    });

    // Debug listener to confirm event reception
    window.addEventListener('shoppieAINudgeUpdated', (event) => {
      console.log('shoppieAINudgeUpdated received:', event.detail);
    });
  </script>

  <!--
Paste this script at the bottom of your HTML before the </body> tag.
See more style and config options on our docs
https://github.com/Mintplex-Labs/anything-llm/tree/master/embed/README.md
-->
  <!-- <script
  data-embed-id="337815d0-17a5-4de8-b331-ff28c766d12f"
  data-base-api-url="https://anythingllm.goshoppie.com/api/embed"
  src="dist/anythingllm-chat-widget.js">
</script> -->
  <!-- AnythingLLM (https://anythingllm.com) -->



</body>

</html>



<!-- <script data-base-api-url="https://anythingllm-dev1.goshoppie.com/api/embed" src="dist/anythingllm-chat-widget.js">
  </script> -->
<!-- // script.setAttribute('data-nudge-appear', true);
    // script.setAttribute('data-nudge-text', "I saw u were checking our shampoo, get this conditioner also makes your hair bouncy"); -->

<!-- // / dist/anythingllm-chat-widget.js
    // https://anythingllm-dev1.goshoppie.com/embed/anythingllm-chat-widget.min.js -->